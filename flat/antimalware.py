from AMconfigtenant1 import AMconfigtenant1
from CreateandReplaceAMConfigTenant2 import AmconfigTenant2, AmReplaceConfig
from AMCheckandRename import AmConfigCheck, RenameAmConfig


def am_config_transform(antimalwareconfig, OLD_HOST, OLD_API_KEY):
    amdirectorylist, amfileextentionlist, amfilelist, allamconfig = AMconfigtenant1(
        antimalwareconfig, OLD_HOST, OLD_API_KEY
    )

    return amdirectorylist, amfileextentionlist, amfilelist, allamconfig


def am_validate_create(
    allofpolicy,
    antimalwareconfig,
    allamconfig,
    amdirectorylist,
    amalldirectorynew,
    amfileextentionlist,
    amallfileextentionnew,
    amfilelist,
    amallfilelistnew,
    NEW_HOST,
    NEW_API_KEY,
):
    mod_allamconfig = AmConfigCheck(
        allamconfig,
        amdirectorylist,
        amalldirectorynew,
        amfileextentionlist,
        amallfileextentionnew,
        amfilelist,
        amallfilelistnew,
    )

    mod_allamconfig = RenameAmConfig(mod_allamconfig)

    allamconfignew = AmconfigTenant2(mod_allamconfig, NEW_HOST, NEW_API_KEY)

    aop_replace_am_configs = AmReplaceConfig(
        allofpolicy, antimalwareconfig, allamconfignew
    )
    final = aop_replace_am_configs
    return final
